---
title: "Quant - Assignment 1"
author: "Cat"
date: "8/13/2020"
output: html_document
---
## Load Packages and Data

```{r}
library(tidycensus)
library(tidyverse)
```


```{r}
options(tigris_use_cache = TRUE)
census_api_key("f96e31b3e535fc7cd31223fcf140d31f8f1bfe76", overwrite = TRUE, install = TRUE)

readRenviron("~/.Renviron")
```
## Finding Variables 
```{r}
person_vars_2018 <- pums_variables %>%
  distinct(year, survey, var_code, 
           var_label, data_type, level) %>%
  filter(level == "person", year == 2018, survey == "acs1")
person_vars_2018
```

```{r}
hh_vars_2018 <- pums_variables %>%
  distinct(year, survey, var_code, 
           var_label, data_type, level) %>%
  filter(level == "housing", year == 2018, survey == "acs1")
hh_vars_2018
```

```{r}
area_vars_2018 <- load_variables(2018, "acs1")
area_vars_2018
```
```{r}
area_vars_2010 <- load_variables(2010, "sf1")
area_vars_2010
```
##Variables used: 
1. Part of the total population unemployed in civilian labor force (age 16 years and above)(continuous)
2. Part of the total population who are males in labor force who were never married(continuous)
3. Part of the total population who are less than high school graduates in labor force(continuous)
4. Whether the majority of the population is white alone (not Hispanic or Latino) or not(categorical)
5. Whether the majority of the population is foreign born or not(categorical)
```{r}
pop_vars <- c(unemp_civlabor_16= "B23025_005", 
              male_nm_labor= "B12006_004",
              not_grad_labor= "B23006_004", 
              total_pop= "B01001A_001", 
              white_only= "B01001H_001",
              foreign_born= "B05002_013")

counties2018 <- get_acs(geography= "county", 
              variables= pop_vars, 
              output= "wide", 
              year = 2018, 
              survey= "acs1")

rural_vars <- c(total_hh= "H002001", rural_hh= "H002005")

counties_rural <- get_decennial(geography= "county",
                variables= rural_vars, 
                output= "wide", 
                year = 2010)

counties2 <- inner_join(counties2018,counties_rural,by = "GEOID") %>% 
  mutate(unemp_civlabor_16 = unemp_civlabor_16E / total_popE,
         male_nm_labor = male_nm_laborE / total_popE, 
         not_grad_labor = not_grad_laborE / total_popE, 
         white_nhl = white_onlyE / total_popE > 0.5,
         foreign = foreign_bornE / total_popE >0.5 ) %>% 
  select(unemp_civlabor_16, male_nm_labor, not_grad_labor, white_nhl, foreign)



write_csv(counties2,"counties2.csv")